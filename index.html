<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Schafkopf iPad Duel</title>

<style>

body{
    margin:0;
    font-family:Arial;
    background:#020617;
    color:white;
}

/* Gesamt-App */
#app{
    height:100vh;
    display:flex;
    flex-direction:column;
    max-width:800px;
    margin:auto;
}

/* Spielerzonen */
.player{
    height:25vh;
    border-bottom:2px solid #22c55e;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
}

.top{
    transform:rotate(180deg);
    border-top:2px solid #22c55e;
    border-bottom:none;
}

/* Mittelzone = frei */
#center{
    flex:1;
    background:#020617;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
}

/* Karten */
.hand{
    display:flex;
    gap:10px;
}

.card{
    background:#0f172a;
    padding:10px 15px;
    border-radius:8px;
    cursor:pointer;
    font-size:0.9rem;
    border:2px solid transparent;
}

.card:hover{
    border:2px solid #22c55e;
}

.selected{
    border:2px solid gold;
}

/* Buttons klein */
button{
    padding:6px 12px;
    margin:4px;
    font-size:0.8rem;
    border:none;
    border-radius:6px;
    background:#16a34a;
    color:white;
    cursor:pointer;
}

#info{
    font-size:1.1rem;
    color:#4ade80;
    white-space:pre-line;
}

</style>
</head>

<body>

<div id="app">

<!-- Spieler Oben -->
<div class="player">

<h4>Spieler Oben</h4>

<div id="hand1" class="hand"></div>

<button onclick="lockPick(1)">Auswahl sperren</button>

</div>


<!-- Mitte (frei) -->
<div id="center">

<div>

<p id="starter"></p>

<button onclick="reveal()">Aufdecken</button>

<div id="info"></div>

<button onclick="restart()">Neue Runde</button>

</div>

</div>


<!-- Spieler Unten -->
<div class="player bottom">

<h4>Spieler Unten</h4>

<div id="hand2" class="hand"></div>

<button onclick="lockPick(2)">Auswahl sperren</button>

</div>

</div>


<script>

// Farben
const suits = ["Eichel","Laub","Herz","Schell"];

// R√§nge
const ranks = [
    {name:"Ober",value:6,trump:true},
    {name:"Unter",value:5,trump:true},
    {name:"10",value:4,trump:false},
    {name:"9",value:3,trump:false},
    {name:"8",value:2,trump:false},
    {name:"7",value:1,trump:false}
];

function randomCard(){

    let s = suits[Math.floor(Math.random()*4)];
    let r = ranks[Math.floor(Math.random()*6)];

    return{
        suit:s,
        rank:r,
        power:r.value,
        name:r.name+" "+s
    };
}


// 3 Karten pro Spieler
let p1Hand=[];
let p2Hand=[];

let pick1=null;
let pick2=null;

let lock1=false;
let lock2=false;

// Starter
let starter;


// Setup
function setup(){

    p1Hand=[];
    p2Hand=[];

    for(let i=0;i<3;i++){
        p1Hand.push(randomCard());
        p2Hand.push(randomCard());
    }

    pick1=null;
    pick2=null;

    lock1=false;
    lock2=false;

    starter = Math.random()<0.5 ? 1:2;

    document.getElementById("starter").innerText=
        "üé≤ Angeber: Spieler "+
        (starter===1?"Oben":"Unten");

    info.innerText="";

    renderHands();
}


// Karten anzeigen
function renderHands(){

    hand1.innerHTML="";
    hand2.innerHTML="";

    p1Hand.forEach((c,i)=>{

        let div=document.createElement("div");
        div.className="card";
        div.innerText=c.name;

        div.onclick=()=>selectCard(1,i,div);

        hand1.appendChild(div);
    });

    p2Hand.forEach((c,i)=>{

        let div=document.createElement("div");
        div.className="card";
        div.innerText=c.name;

        div.onclick=()=>selectCard(2,i,div);

        hand2.appendChild(div);
    });
}


// Auswahl
function selectCard(p,i,el){

    if(p===1 && lock1) return;
    if(p===2 && lock2) return;

    if(p===1){

        pick1=p1Hand[i];

        document.querySelectorAll("#hand1 .card")
        .forEach(c=>c.classList.remove("selected"));

        el.classList.add("selected");
    }

    if(p===2){

        pick2=p2Hand[i];

        document.querySelectorAll("#hand2 .card")
        .forEach(c=>c.classList.remove("selected"));

        el.classList.add("selected");
    }
}


// Sperren
function lockPick(p){

    if(p===1){

        if(!pick1){
            alert("Erst Karte w√§hlen!");
            return;
        }

        lock1=true;
    }

    if(p===2){

        if(!pick2){
            alert("Erst Karte w√§hlen!");
            return;
        }

        lock2=true;
    }
}


// Auswertung
function reveal(){

    if(!lock1 || !lock2){
        alert("Beide m√ºssen sperren!");
        return;
    }

    let first = starter===1 ? pick1:pick2;
    let second = starter===1 ? pick2:pick1;

    let winner = starter;

    // Trumpf-Regel
    if(first.rank.trump && !second.rank.trump){}
    else if(!first.rank.trump && second.rank.trump){
        winner = starter===1?2:1;
    }

    // Beide Trumpf
    else if(first.rank.trump && second.rank.trump){

        if(second.power>first.power){
            winner = starter===1?2:1;
        }
    }

    // Farbe
    else if(first.suit===second.suit){

        if(second.power>first.power){
            winner = starter===1?2:1;
        }
    }

    info.innerText=
        "Oben: "+pick1.name+
        "\nUnten: "+pick2.name+
        "\n\nüèÜ Gewinner: Spieler "+
        (winner===1?"Oben":"Unten");
}


// Neustart
function restart(){
    setup();
}


// Start
setup();

</script>

</body>
</html>
